<span class="slc">--</span>
<span class="slc">-- The Computer Language Shootout</span>
<span class="slc">-- http://shootout.alioth.debian.org/</span>
<span class="slc">--</span>
<span class="slc">-- compile with : ghc fastest.hs -o fastest</span>
<span class="slc">--</span>
<span class="slc">-- contributed by Greg Buchholz</span>
<span class="slc">-- Modified by Mirko Rahn, Don Stewart, Chris Kuklewicz and Lemmih</span>
<span class="slc">--</span>
<span class="kwa">import</span> Data.<span class="kwb">Char</span>

main <span class="sym">=</span> print . new <span class="num">0</span> <span class="sym">=&lt;&lt;</span> getContents

new i <span class="sym">[]       =</span> i
new i <span class="sym">(</span>'<span class="sym">-</span>'<span class="sym">:</span>xs<span class="sym">) =</span> neg <span class="num">0</span> xs
    <span class="kwa">where</span> neg n <span class="sym">(</span>'\n'<span class="sym">:</span>xs<span class="sym">) =</span> new <span class="sym">(</span>i <span class="sym">-</span> n<span class="sym">)</span> xs
          neg n <span class="sym">(</span>x   <span class="sym">:</span>xs<span class="sym">) =</span> neg <span class="sym">(</span>parse x <span class="sym">+ (</span><span class="num">10</span> <span class="sym">*</span> n<span class="sym">))</span> xs
new i <span class="sym">(</span>x<span class="sym">:</span>xs<span class="sym">) =</span> pos <span class="sym">(</span>parse x<span class="sym">)</span> xs
    <span class="kwa">where</span> pos n <span class="sym">(</span>'\n'<span class="sym">:</span>xs<span class="sym">) =</span> new <span class="sym">(</span>i <span class="sym">+</span> n<span class="sym">)</span> xs
          pos n <span class="sym">(</span>x   <span class="sym">:</span>xs<span class="sym">) =</span> pos <span class="sym">(</span>parse x <span class="sym">+ (</span><span class="num">10</span> <span class="sym">*</span> n<span class="sym">))</span> xs

parse c <span class="sym">=</span> ord c <span class="sym">-</span> ord '<span class="num">0</span>'
