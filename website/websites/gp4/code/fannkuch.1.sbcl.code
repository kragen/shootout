<span class="slc">;;; The Computer Language Shootout</span>
<span class="slc">;;; http://shootout.alioth.debian.org/</span>
<span class="slc">;;; Contributed by Robbert Haarman</span>
<span class="slc">;;;</span>
<span class="slc">;;; fannkuch for Lisp (SBCL)</span>
<span class="slc">;;;</span>
<span class="slc">;;; Compile: sbcl --load fannkuch.lisp --eval &quot;(save-lisp-and-die \&quot;fannkuch.core\&quot; :purify t :toplevel (lambda () (main) (quit)))&quot;</span>
<span class="slc">;;;</span>
<span class="slc">;;; Run: sbcl --noinform --core fannkuch.core %A</span>

<span class="sym">(</span>proclaim <span class="sym">'(</span>optimize <span class="sym">(</span>speed <span class="num">3</span><span class="sym">)</span>
	<span class="sym">(</span>safety <span class="num">0</span><span class="sym">) (</span>debug <span class="num">0</span><span class="sym">) (</span>space <span class="num">0</span><span class="sym">) (</span>compilation<span class="sym">-</span>speed <span class="num">0</span><span class="sym">)))</span>

<span class="sym">(</span>defparameter <span class="sym">*</span><span class="kwa">print</span><span class="sym">-</span>perms<span class="sym">*</span> <span class="num">30</span><span class="sym">)</span>
<span class="sym">(</span>proclaim <span class="sym">'(</span>fixnum <span class="sym">*</span><span class="kwa">print</span><span class="sym">-</span>perms<span class="sym">*))</span>

<span class="sym">(</span><span class="kwa">defun print</span><span class="sym">-</span>permutation <span class="sym">(</span>permutation<span class="sym">)</span>
	<span class="sym">(</span>format t <span class="str">&quot;窿ウ聃雉患箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷俱镥蜚疱蝽豸狒轱俭疳沆狍蠼Ⅲ恝晶集箴犷炯箴犷沆狍蠼㈦麽⒕扉篝集箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷骒轲俭疳沆狍蠼Ⅲ恝鲸集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷箝眇戾俭疳沆狍蠼Ⅲ恝经集箴犷决邈麸疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷绢俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬轼铛罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷捐犰俭疳沆狍蠼Ⅲ恝鲸集箴犷炬祜矧俭疳沆狍蠼㈩蹴⒕布箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷镲骘骝镯俭疳沆狍蠼㈩蹴⒕凹箴犷麸俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷栳戽俭疳沆狍蠼Ⅲ恝京集箴犷滹俭疳沆狍蠼Ⅲ恝鲸集箴犷掘雉狒彐俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱榧箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼Ⅲ恝鲸集箴犷俭疳沆狍蠼Ⅲ恝经集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷倔弭俭疳沆狍蠼Ⅲ恝鲸集箴犷俭疳沆狍蠼㈩蹴⒕布箴犷炯箴犷沆狍蠼Ⅲ恝京┅┅┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷泔躅艏箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼俭疳沆狍蠼Ⅲ恝鲸集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷箝眇戾俭疳沆狍蠼Ⅲ恝经集箴犷决邈麸疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷镲骘骒轲骈铛俭疳沆狍蠼Ⅲ恝窘集箴犷俭疳沆狍蠼㈩蹴⒕凹箴犷翳孱俭疳沆狍蠼Ⅲ恝鲸集箴犷鹃钽骒轲蠹箴犷沆狍蠼Ⅲ恝京集箴犷躅糸俭疳沆狍蠼Ⅲ恝鲸集箴犷爵桢骈铛俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝京集箴犷滹俭疳沆狍蠼Ⅲ恝鲸集箴犷炬扉疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京集箴犷骈钺祆俭疳沆狍蠼Ⅲ恝鲸集箴犷掘弭躜骒轲蠹箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷磲脲俭疳沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝鲸集箴犷绢俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬轼铛罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷卷犭寮箴犷沆狍蠼Ⅲ恝经集箴犷踞蝌狴俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕扉篝集箴犷罴箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝竞集箴犷鹃铋糸犰俭疳沆狍蠼Ⅲ恝经集箴犷俱镱翦铘俭疳沆狍蠼Ⅲ恝鲸集箴犷眷镲骘骝镯俭疳沆狍蠼㈩蹴⒕奔箴犷麸泔祆邈糸铉榧箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷蝻翎翦俭疳沆狍蠼Ⅲ恝经集箴犷炬轵篝俭疳沆狍蠼Ⅲ恝鲸集箴犷攫弪眭翎糸镱罴箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕豉疱集箴犷箝眇戾俭疳沆狍蠼Ⅲ恝经集箴犷决邈麸疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炬轼铛罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷绝俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句雉轫弩俭疳沆狍蠼Ⅲ恝鲸集箴犷鹃俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷倔弭俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱榧箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝精集箴犷榧箴犷沆狍蠼Ⅲ恝京┅┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷倔弭俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝈疱蝽豸狒轱俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷汜祆俭疳沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱蠹箴犷沆狍蠼Ⅲ恝经集箴犷掘邈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬躅疱蝽豸狒轱戾罴箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬躅泗轱骢罴箴犷沆狍蠼Ⅲ恝京集箴犷炬轼铛戾罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷攫弪俭疳沆狍蠼Ⅲ恝鲸集箴犷俱镳俭疳沆狍蠼Ⅲ恝经集箴犷倔羼疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕殒集箴犷俭疳沆狍蠼Ⅲ恝鲸郊箴犷戾俭疳沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝京集箴犷炬躅汜祆骢疱蝽俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕痱镧罴箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句雉轫弩俭疳沆狍蠼Ⅲ恝鲸集箴犷鹃俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷戾罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷俱犰旒箴犷沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱蠹箴犷沆狍蠼Ⅲ恝经集箴犷掘邈骢疱蝽俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷戾罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷掘雉狒寮箴犷沆狍蠼Ⅲ恝经集箴犷炬轵篝疱蝽戾罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷俱犰旒箴犷沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱蠹箴犷沆狍蠼Ⅲ恝经集箴犷掘邈骢疱蝽俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈩蹴⒕奔箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷戾罴箴犷沆狍蠼Ⅲ恝京┅┅┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷汜祆俭疳沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝鲸集箴犷炬躅轭轸獒旒箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷俱犰旒箴犷沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱蠹箴犷沆狍蠼Ⅲ恝经集箴犷掘邈骢轭轸獒旒箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝鲸集箴犷踞蝌狴俭疳沆狍蠼Ⅲ恝经集箴犷句轫孱箝镱轭轸獒旒箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷驷铑膈汨俭疳沆狍蠼Ⅲ恝鲸集箴犷绢俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷攫蜷铘邃俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京集箴犷炯箴犷沆狍蠼㈦麽⒕磲集箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼俭疳沆狍蠼㈩蹴⒕凹箴犷炯箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬轼铛痱轭翦俭疳沆狍蠼㈦麽⒕磲集箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼俭疳沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷俱犰旒箴犷沆狍蠼Ⅲ恝经集箴犷诀轸杓箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕灬礅溽集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷攫弪眭翎糸镱俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷诀桢俭疳沆狍蠼Ⅲ恝鲸祠患箴犷痱轭翦俭疳沆狍蠼Ⅲ恝惊集箴犷炯箴犷沆狍蠼㈦麽⒕痱轭艏箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眢俭疳沆狍蠼Ⅲ恝惊┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕痱轭艏箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷鹃钽痱轭翦浼箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷炬扉痼俭疳沆狍蠼Ⅲ恝鲸集箴犷俱秕铘俭疳沆狍蠼Ⅲ恝经集箴犷炬扉痼疱蝽豸狒轱罴箴犷沆狍蠼Ⅲ恝京┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷句邈灬蝈俭疳沆狍蠼Ⅲ恝鲸集箴犷炬轼铛骒轲蠹箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕殒集箴犷俭疳沆狍蠼Ⅲ恝鲸玺患箴犷骒轲俭疳沆狍蠼㈦麽⒕磲集箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼俭疳沆狍蠼Ⅲ恝京集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷倔弭俭疳沆狍蠼㈦麽⒕磲集箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼骒轲蠹箴犷沆狍蠼Ⅲ恝京┅┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷卷犭寮箴犷沆狍蠼Ⅲ恝经集箴犷攫弪眭翎糸镱罴箴犷沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼㈦麽⒕磲集箴犷炯箴犷沆狍蠼Ⅲ恝经集箴犷炬扉痼俭疳沆狍蠼Ⅲ恝京┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炯箴犷沆狍蠼㈦麽⒕溴骢罴箴犷磲轭俭疳沆狍蠼Ⅲ恝鲸┘箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷眷弭俭疳沆狍蠼Ⅲ恝鲸集箴犷倦蹉桢俭疳沆狍蠼Ⅲ恝鲸集箴犷攫狎箦俭疳沆狍蠼Ⅲ恝经集箴犷鹃铘彗弪俭疳沆狍蠼Ⅲ恝鲸集箴犷倔邈镱俭疳沆狍蠼Ⅲ恝惊集箴犷攫矬轼俭疳沆狍蠼Ⅲ恝经集箴犷踞蜱黾箴犷沆狍蠼Ⅲ恝惊┅┅集箴犷俭疳沆狍蠼Ⅲ恝鲸集箴犷炬矧磲俭疳沆狍蠼Ⅲ趄⒕聃雉恍驷铑膈汨孱俩窿ウ聃雉患箴犷膈汨孱俭疳沆狍蠼Ⅲ恝鲸集箴犷炬犷铍蹉膈汨孱俭疳沆狍蠼Ⅲ恝京┅┘箴犷